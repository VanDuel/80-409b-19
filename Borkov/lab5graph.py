import numpy as np
import matplotlib.pyplot as plt
import math

# точное решение
u = [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
[0.58779, 0.50192, 0.4286, 0.366, 0.31253, 0.26688, 0.22789, 0.1946, 0.16618, 0.1419, 0.12117],
[0.95106, 0.81213, 0.6935, 0.59219, 0.50569, 0.43182, 0.36874, 0.31488, 0.26888, 0.2296, 0.19606],
[0.95106, 0.81213, 0.6935, 0.59219, 0.50569, 0.43182, 0.36874, 0.31488, 0.26888, 0.2296, 0.19606],
[0.58779, 0.50192, 0.4286, 0.366, 0.31253, 0.26688, 0.22789, 0.1946, 0.16618, 0.1419, 0.12117],
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
[-0.58779, -0.50192, -0.4286, -0.366, -0.31253, -0.26688, -0.22789, -0.1946, -0.16618, -0.1419, -0.12117],
[-0.95106, -0.81213, -0.6935, -0.59219, -0.50569, -0.43182, -0.36874, -0.31488, -0.26888, -0.2296, -0.19606],
[-0.95106, -0.81213, -0.6935, -0.59219, -0.50569, -0.43182, -0.36874, -0.31488, -0.26888, -0.2296, -0.19606],
[-0.58779, -0.50192, -0.4286, -0.366, -0.31253, -0.26688, -0.22789, -0.1946, -0.16618, -0.1419, -0.12117],
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]

# явный
u1 = [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
[0.58779, 0.49798, 0.4219, 0.35744, 0.30282, 0.25656, 0.21736, 0.18415, 0.15601, 0.15601, 0.13218],
[0.95106, 0.80575, 0.68264, 0.57834, 0.48998, 0.41512, 0.35169, 0.29796, 0.25244, 0.25244, 0.21387],
[0.95106, 0.80575, 0.68264, 0.57834, 0.48998, 0.41512, 0.35169, 0.29796, 0.25244, 0.25244, 0.21387],
[0.58779, 0.49798, 0.4219, 0.35744, 0.30282, 0.25656, 0.21736, 0.18415, 0.15601, 0.15601, 0.13218],
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
[-0.58779, -0.49798, -0.4219, -0.35744, -0.30282, -0.25656, -0.21736, -0.18415, -0.15601, -0.15601, -0.13218],
[-0.95106, -0.80575, -0.68264, -0.57834, -0.48998, -0.41512, -0.35169, -0.29796, -0.25244, -0.25244, -0.21387],
[-0.95106, -0.80575, -0.68264, -0.57834, -0.48998, -0.41512, -0.35169, -0.29796, -0.25244, -0.25244, -0.21387],
[-0.58779, -0.49798, -0.4219, -0.35744, -0.30282, -0.25656, -0.21736, -0.18415, -0.15601, -0.15601, -0.13218],
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]

# неявный
u2 = [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
[0.58779, 0.50988, 0.4423, 0.38368, 0.33283, 0.28872, 0.25045, 0.21726, 0.18846, 0.18846, 0.16349],
[0.95106, 0.82501, 0.71566, 0.62081, 0.53853, 0.46716, 0.40524, 0.35153, 0.30494, 0.30494, 0.26452],
[0.95106, 0.82501, 0.71566, 0.62081, 0.53853, 0.46716, 0.40524, 0.35153, 0.30494, 0.30494, 0.26452],
[0.58779, 0.50988, 0.4423, 0.38368, 0.33283, 0.28872, 0.25045, 0.21726, 0.18846, 0.18846, 0.16349],
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
[-0.58779, -0.50988, -0.4423, -0.38368, -0.33283, -0.28872, -0.25045, -0.21726, -0.18846, -0.18846, -0.16349],
[-0.95106, -0.82501, -0.71566, -0.62081, -0.53853, -0.46716, -0.40524, -0.35153, -0.30494, -0.30494, -0.26452],
[-0.95106, -0.82501, -0.71566, -0.62081, -0.53853, -0.46716, -0.40524, -0.35153, -0.30494, -0.30494, -0.26452],
[-0.58779, -0.50988, -0.4423, -0.38368, -0.33283, -0.28872, -0.25045, -0.21726, -0.18846, -0.18846, -0.16349],
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]

# явно-неявный
u3 = [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
[0.58779, 0.50393, 0.4321, 0.37056, 0.31783, 0.27264, 0.23391, 0.19243, 0.18846, 0.16413, 0.16349],
[0.95106, 0.81538, 0.69915, 0.59958, 0.51426, 0.44114, 0.37847, 0.31135, 0.30494, 0.26556, 0.26452],
[0.95106, 0.81538, 0.69915, 0.59958, 0.51426, 0.44114, 0.37847, 0.31135, 0.30494, 0.26556, 0.26452],
[0.58779, 0.50393, 0.4321, 0.37056, 0.31783, 0.27264, 0.23391, 0.19243, 0.18846, 0.16413, 0.16349],
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
[-0.58779, -0.50393, -0.4321, -0.37056, -0.31783, -0.27264, -0.23391, -0.19243, -0.18846, -0.16413, -0.16349],
[-0.95106, -0.81538, -0.69915, -0.59958, -0.51426, -0.44114, -0.37847, -0.31135, -0.30494, -0.26556, -0.26452],
[-0.95106, -0.81538, -0.69915, -0.59958, -0.51426, -0.44114, -0.37847, -0.31135, -0.30494, -0.26556, -0.26452],
[-0.58779, -0.50393, -0.4321, -0.37056, -0.31783, -0.27264, -0.23391, -0.19243, -0.18846, -0.16413, -0.16349],
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]


a = 0.01
N = 11
T_end = 3
X_end = math.pi
X = np.linspace(0, X_end, N)
T = np.linspace(0, T_end, N)

h = X_end / N
tau = T_end / N
sigma = a*a*tau/h/h

fig = plt.figure()
ax = fig.add_subplot(111, projection='3d')

Q, W = np.meshgrid(X, T)
ax.plot_surface(W, Q, np.array(u3))

ax.set_xlabel('t Label')
ax.set_ylabel('x Label')
ax.set_zlabel('u Label')
plt.show()